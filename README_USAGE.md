# 成績報表整理工具 - 使用說明

## 功能

此工具可以讀取學生成績資料和教師任課資料，自動配對並產生個別教師的 CSV 成績報表。

## 執行方式

```bash
cd gradeReport
go run main.go
```

或使用執行腳本：

```bash
./gradeReport/run.sh
```

## 輸入檔案

1. **gradeReport/data/grade.csv** - 學生成績資料
   - **固定欄位（索引 0-13）**：科目代號, 科目名稱, 學號, 年級, 班級, 座號, 學生姓名, 組別, 選擇, 非選擇, 補考扣, 違規, 補考扣分, 成績
   - **動態欄位（索引 14+）**：答案1, 答案2, ...（長度依考試而定）
   - 程式使用固定位置讀取索引 0-13 的欄位，不依賴表頭文字
   - 由 grade.xlsm 轉換而來，保留所有原始欄位

2. **gradeReport/data/teacher.csv** - 教師任課資料
   - 欄位：科目代號, 科目名稱, 年級, 班級, 組別, 老師名稱, email

## 輸出檔案

程式會在 `gradeReport/output/` 目錄下產生 CSV 檔案，檔案命名格式：

```
{教師名稱}_年級{年級}_{科目名稱}.csv
```

例如：
- `老師1_年級2_國文.csv`
- `老師1_年級2_歷史.csv`
- `老師1_年級3_國文.csv`

## 配對邏輯

使用以下條件配對學生與教師：
- 科目代號 (必須完全相同)
- 年級 (必須完全相同)
- 班級 (必須完全相同)
- 組別 (必須完全相同)

## 分組規則

根據規格需求：
- 一個老師在**一個年級、一個科目**下會收到**一份檔案**
- 同一年級、同一科目的多個班級會合併在同一個檔案中
- 檔案內依照班級和座號排序

### 範例

若老師1教：
- 年級 2, 3
- 班級 1, 2
- 科目：國文、歷史

則老師1會收到 3 份檔案：
1. `老師1_年級2_國文.csv` (包含年級2的班級1和2)
2. `老師1_年級2_歷史.csv` (包含年級2的班級1)
3. `老師1_年級3_國文.csv` (包含年級3的班級1)

**重點：同一老師、同一年級、不同科目 → 分開成不同檔案**

## 執行結果

程式執行時會顯示：
- 讀取的成績資料筆數
- 讀取的教師資料筆數
- 成功配對的報表群組數量
- 產生的每個 Excel 檔案名稱及資料筆數
- 若有學生找不到對應教師，會顯示警告訊息

## 注意事項

1. 如果出現「找不到對應教師」的警告，請檢查：
   - teacher.csv 是否包含該科目、年級、班級、組別的教師資料
   - 科目代號、年級、班級、組別是否完全一致（包括空格）

2. 目前組別配對使用精確比對，如需實作特殊規則，請修改 `buildTeacherMap` 和 `matchStudentsToTeachers` 函數

## 開發資訊

- 使用語言：Go 1.24.3
- CSV 處理：標準庫 encoding/csv
- 程式架構：
  - [gradeReport/main.go](gradeReport/main.go) - 主程式
  - [gradeReport/run.sh](gradeReport/run.sh) - 執行腳本
  - [gradeReport/data/](gradeReport/data/) - 輸入資料目錄（CSV 格式）
  - [gradeReport/output/](gradeReport/output/) - 輸出報表目錄（CSV 格式）
